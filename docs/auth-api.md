# 인증 API

학교 계정을 사용한 로그인을 지원합니다.

다음 용도로 활용할 수 있습니다:

- 사용자가 재학생임을 인증.
- API가 제공하는 토큰(JWT)을 사용해 로그인 상태를 관리.

## 학교 계정으로 로그인

학번과 포털 비밀번호로 로그인할 수 있습니다. 로그인에 성공할 경우 `200 OK` 응답이, 그렇지 않을 경우 `401 Unauthorized` 응답이 돌아옵니다.

사용자가 재학생이며 본인임을 인증하는 데에 활용할 수 있습니다.

### POST /auth/login

|      요청 본문 필드      |                                 설명                   |
|----------------------|-------------------------------------------------------|
| `id`                 | 학번입니다. 필수입니다.                                     |
| `password`(선택)      | 포털 비밀번호입니다. `refreshToken`이 있다면 필요하지 않습니다.   |
| `refreshToken`(선택)  | 리프레시 토큰입니다. `password`가 있다면 필요하지 않습니다.       |

> `id`는 항상 필수이지만 `password`와 `refreshToken`은 둘 중 하나만 있으면 됩니다. `id`와 `password`의 조합, `id`와 `refreshToken`의 조합이 가능합니다.

> 위 내용은 요청의 body(본문)에 들어갑니다.

> 요청 본문의 Content-Type은 `application/www-form-urlencoded`와 `application/json`을 지원합니다.

### 응답

|          응답 코드       |                                응답 본문                               |
|------------------------|----------------------------------------------------------------------|
| 200(정상)               | `{"accessToken": "새 액세스 토큰", "refreshToken": "새 리프레시 토큰"}`      |                                                       |
| 400(요청 파라미터가 비정상)  | `{"message": "요청이 망한 이유"}`                                        |                                                       |
| 401(로그인 실패)          | `{"message": "요청이 망한 이유"}`                                        |                                                       |

> 응답의 Content-Type은 `application/json`입니다.

### 테스트

~~~bash
curl -X POST -d "id=학번&password=비밀번호" https://api.inuappcenter.kr/auth/login
~~~

## 로그인 정보(세션) 확인

위의 로그인 API는 로그인 성공시 서비스에서 바로 사용 가능한 `accessToken`과 추후 자동로그인에 사용할 수 있는 `refreshToken`을 제공합니다.

이 `accessToken`의 유효성과 그 안에 담겨있는 정보를 조회할 수 있습니다. 올바른 토큰일 경우 `200 OK` 응답이, 토큰이 만료되었거나 로그인 API에 의해 서명된 것이 아니라면 `401 Unauthorized` 응답이 돌아옵니다.

**GET /auth/session**

|       헤더 필드        |                                          설명                                                 |
|----------------------|----------------------------------------------------------------------------------------------|
| `Authorization`      | 인증 정보를 담은 헤더입니다. `Bearer {로그인하고 발급받은 accessToken}`의 형태입니다. 대소문자 주의해주세요.                                    |

> 위 내용은 요청의 헤더에 들어갑니다. 요청에 필요한 body는 없습니다.

> 대소문자 주의해주세요. `Bearer`는 대문자로 시작해야 합니다.

> 예를 들어, `accessToken`의 값이 `abcd`라면, `Authorization` 헤더의 값은 `Bearer abcd`입니다.

### 응답

|          응답 코드       |                                응답 본문                               |
|------------------------|----------------------------------------------------------------------|
| 200(정상)               | `{"id": "학번", "issuedAt": "로그인 시점", "expiresAt": "로그인 만료 시점"}` |                                                       |
| 400(요청 파라미터가 비정상)  | `{"message": "요청이 망한 이유"}`                                        |                                                       |
| 401(로그인 실패)          | `{"message": "요청이 망한 이유"}`                                        |                                                       |

> 응답의 Content-Type은 `application/json`입니다.

### 테스트

~~~bash
curl -X GET -H "Authorization: Bearer {발급받은 accessToken}" https://api.inuappcenter.kr/auth/session
~~~
